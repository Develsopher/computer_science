# 동기화

동시다발적으로 실행도는 많은 프로세스는 서로 데이터를 주고받으며 협력하며 실행될 수 있다. 이 때 실행 순서와 자원의 일관성을 보장하기 위해 동기화되어야 한다.

-   프로세스 동기화 : 프로세스들 사이의 수행 시기를 맞추는 것
    -   실행 순서 제어 : 프로세스를 올바른 순서대로 실행하기
    -   상호 배제 : 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근하게 하기

## 실행 순서 제어

동시에 실행되는 프로세스를 올바른 순서대로 실행하는 것
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FllnZb%2FbtsCtHoy0t9%2FEluRngPkzW4DGIDFK2kSIK%2Fimg.jpg">
## 상호 배제

공유가 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FcqTlKv%2FbtsCo6RaJL2%2Fs2ku88H0C7ELlT2IIySGkk%2Fimg.jpg">
*문맥 교환 : 기존 프로세스의 문맥을 PCB에 백업하고, 새로운 프로세스를 실행하기 위해 문맥을 PCB로부터 복구하여 새로운 프로세스를 실행하는 것
<details>
<summary>문맥교환 타이밍</summary>
<div markdown="1">
값을 저장한 후 일어나야 할 것 같은데 그 전에 실행되는 이유가 뭐야?"입니다. 문맥 교환(context switching)이란 멀티태스킹 운영 시스템에서 CPU가 한 작업에서 다른 작업으로 전환할 때 발생하는 과정을 말합니다.

문맥 교환이 값을 저장한 후에 일어나야 하는 것이 일반적인데, 만약 그 전에 실행되고 있다면, 여러 가능한 이유가 있을 수 있습니다. 예를 들어, 시스템의 인터럽트 처리, 우선 순위 변경, 자원의 부족 또는 오류 등으로 인해 문맥 교환이 더 일찍 발생할 수 있습니다. 이는 특정 작업의 실행 중에 긴급하게 처리해야 하는 다른 작업이 발생했을 때 일어날 수 있습니다.

또 다른 가능성은 프로그램의 로직이나 시스템의 스케줄링 알고리즘에 따라서 문맥 교환의 시점이 조정되었을 수 있습니다. 예를 들어, 고정 우선 순위 스케줄링에서는 더 높은 우선 순위를 가진 프로세스가 준비 상태가 되면 즉시 CPU를 점유할 수 있습니다.

더 구체적인 분석을 위해서는 해당 시스템의 스케줄링 정책과 프로그램의 코드, 현재의 작업 상태 등을 확인해야 할 것입니다.
</div>
</details>

### 생산자와 소비자 문제

동시에 접근해서는 안 되는 자원에 동시에 접근하면 발생되는 문제
<img src="https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbx1Ptk%2FbtsCo40aMfu%2FDC3MlvE5jOLqaL3R0Nqexk%2Fimg.png">

-> 총합이 10이 아닌 다른 수가 되거나 실행 중 오류가 난다.  
=> 제대로 동기화 되지 않아 소비자가 생산자의 작업이 끝나기 전에 총합을 수정하거나, 생산자가 소비자의 작업이 끝나기 전에 총합을 수정해 발생한다.

### 공유 자원과 임계 구역

공유 자원 : 전역 변수, 파일, 입출력장치, 보조기억장치 등 동시에 실행되는 프로세스들의 공동 자원  
임계 구역 : 동시에 실행하면 문제가 발생하는 자원에 접근하는 코드 영역

-   두 개 이상의 프로세스가 임계 구역에 진입하고자 하면 둘 중 한나는 대기해야 한다.

레이스 컨디션 : 잘못된 실행으로 인해 여러 프로세스가 동시 다발적으로 임계 구역의 코드를 실행하여 문제가 발생하는 경우  
컴퓨터는 고급 언어가 아닌 저급 언어를 실행하기 때문에 여러 줄의 저급 언어로 변환된 고급 언어 한 줄을 실행하는 과정에서 문맥 교환이 일어날 수 있다.

### 상호 배제를 위한 동기화의 세가지 원칙

1.  상호 배제 : 한 프로세스가 임계 구역에 진입했다면 다른 프로세스는 임계 구역에 들어올 수 없다.
2.  진행 : 임계 구역에 어떤 프로세스도 진입하지 않았다면 임계 구역에 진입하고자 하는 프로세스는 들어갈 수 있어야 한다.
3.  유한 대기 : 한 프로세스 임계 구역에 진입하고 싶다면 언젠가는 들어올 수 있어야 한다.

# 동기화 기법